/**
 * Skipped minification because the original files appears to be already minified.
 * Original file: /npm/context-filter-polyfill@0.3.22/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var ft=Object.defineProperty;var u=(t,e)=>()=>(t&&(e=t(t=0)),e);var mt=(t,e)=>{for(var a in e)ft(t,a,{get:e[a],enumerable:!0})};var f,F=u(()=>{"use strict";f=new Map});var V,v,X,N,S=u(()=>{"use strict";F();V=(t,e="none")=>{var a;(a=e.match(/([-a-z]+)(?:\(([\w\d\s.%-]*)\))?/gim))==null||a.map(i=>{var n;return(n=i.match(/([-a-z]+)(?:\((.*)\))?/i))==null?void 0:n.slice(1,3)}).reduce((i,[n,r])=>f.has(n)?f.get(n)(i,...(r||"").split(" ")):i,t)},v=t=>{let e=parseFloat(t);return/%\s*?$/i.test(t)&&(e/=100),e},X=t=>{let e=parseFloat(t);switch(t.slice(e.toString().length)){case"deg":e/=360;break;case"grad":e/=400;break;case"rad":e/=2*Math.PI;break}return e},N=t=>parseFloat(t)});var ct,Y=u(()=>{"use strict";F();S();ct=(t,e="0")=>{let a=N(e);if(a<=0)return t;let{height:i,width:n}=t.canvas,r=t.getImageData(0,0,n,i),{data:s}=r,o=n-1,l=i-1,p=a+1,y=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1][a],w=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18][a],g=[],D=[],_=[],C=[],O=[],k=[],j=3,c,P,b,I;for(;j-- >0;){let E=0,h=0;for(let x=0;x<i;x++){let T=s[E]*p,z=s[E+1]*p,M=s[E+2]*p,H=s[E+3]*p;for(let d=1;d<=a;d++)c=E+((d>o?o:d)<<2),T+=s[c++],z+=s[c++],M+=s[c++],H+=s[c];for(let d=0;d<n;d++)g[h]=T,D[h]=z,_[h]=M,C[h]=H,x===0&&(O[d]=((c=d+p)<o?c:o)<<2,k[d]=(c=d-a)>0?c<<2:0),P=E+O[d],b=E+k[d],T+=s[P++]-s[b++],z+=s[P++]-s[b++],M+=s[P++]-s[b++],H+=s[P]-s[b],h++;E+=n<<2}for(let x=0;x<n;x++){let T=x,z=g[T]*p,M=D[T]*p,H=_[T]*p,d=C[T]*p;for(let R=1;R<=a;R++)T+=R>l?0:n,z+=g[T],M+=D[T],H+=_[T],d+=C[T];h=x<<2;for(let R=0;R<i;R++)s[h+3]=I=d*y>>>w,I>0?(I=255/I,s[h]=(z*y>>>w)*I,s[h+1]=(M*y>>>w)*I,s[h+2]=(H*y>>>w)*I):s[h]=s[h+1]=s[h+2]=0,x===0&&(O[R]=((c=R+p)<l?c:l)*n,k[R]=(c=R-a)>0?c*n:0),P=x+O[R],b=x+k[R],z+=g[P]-g[b],M+=D[P]-D[b],H+=_[P]-_[b],d+=C[P]-C[b],h+=n<<2}}return t.putImageData(r,0,0),t};f.set("blur",ct)});var yt,$=u(()=>{"use strict";F();S();yt=(t,e="1")=>{if(e=v(e),e===1)return t;e<0&&(e=0);let{height:a,width:i}=t.canvas,n=t.getImageData(0,0,i,a),{data:r}=n,{length:s}=r;for(let o=0;o<s;o+=4)r[o+0]*=e,r[o+1]*=e,r[o+2]*=e;return t.putImageData(n,0,0),t};f.set("brightness",yt)});var gt,q=u(()=>{"use strict";F();S();gt=(t,e="1")=>{if(e=v(e),e===1)return t;e<0&&(e=0);let{height:a,width:i}=t.canvas,n=t.getImageData(0,0,i,a),{data:r}=n,{length:s}=r;for(let o=0;o<s;o+=4)r[o+0]=((r[o+0]/255-.5)*e+.5)*255,r[o+1]=((r[o+1]/255-.5)*e+.5)*255,r[o+2]=((r[o+2]/255-.5)*e+.5)*255;return t.putImageData(n,0,0),t};f.set("contrast",gt)});var ht,J=u(()=>{"use strict";F();S();ht=(t,e,a,i,n)=>{let r=document.createElement("canvas").getContext("2d"),{width:s,height:o}=t.canvas;return r.canvas.width=s,r.canvas.height=o,r.shadowOffsetX=N(e),r.shadowOffsetY=N(a),r.shadowBlur=n?N(i||"0"):0,r.shadowColor=n||i||"transparent",r.drawImage(t.canvas,0,0),t.putImageData(r.getImageData(0,0,s,o),0,0),t};f.set("drop-shadow",ht)});var dt,K=u(()=>{"use strict";F();S();dt=(t,e="0")=>{if(e=v(e),e<=0)return t;e>1&&(e=1);let{height:a,width:i}=t.canvas,n=t.getImageData(0,0,i,a),{data:r}=n,{length:s}=r;for(let o=0;o<s;o+=4){let l=r[o]*.2126+r[o+1]*.7152+r[o+2]*.0722;r[o+0]+=(l-r[o+0])*e,r[o+1]+=(l-r[o+1])*e,r[o+2]+=(l-r[o+2])*e}return t.putImageData(n,0,0),t};f.set("grayscale",dt)});var ut,Q=u(()=>{"use strict";F();S();ut=(t,e="0deg")=>{let a=X(e);if(a<=0)return t;let{height:i,width:n}=t.canvas,r=t.getImageData(0,0,n,i),{data:s}=r,l=(a%1+1)%1*3,p=Math.floor(l),m=l-p,y=1-m,L,w,g,D,_,C,O,k,j;switch(p){default:L=w=g=D=_=C=O=k=j=0;break;case 0:L=y,w=0,g=m,D=m,_=y,C=0,O=0,k=m,j=y;break;case 1:L=0,w=m,g=y,D=y,_=0,C=m,O=m,k=y,j=0;break;case 2:L=m,w=y,g=0,D=0,_=m,C=y,O=y,k=0,j=m;break}let c=0;for(let P=0;P<i;++P)for(let b=0;b<n;++b){c=4*(P*n+b);let I=s[c+0],E=s[c+1],h=s[c+2];s[c+0]=Math.floor(L*I+w*E+g*h),s[c+1]=Math.floor(D*I+_*E+C*h),s[c+2]=Math.floor(O*I+k*E+j*h)}return t.putImageData(r,0,0),t};f.set("hue-rotate",ut)});var Dt,Z=u(()=>{"use strict";F();S();Dt=(t,e="0")=>{if(e=v(e),e<=0)return t;e>1&&(e=1);let{height:a,width:i}=t.canvas,n=t.getImageData(0,0,i,a),{data:r}=n,{length:s}=r;for(let o=0;o<s;o+=4)r[o+0]=Math.abs(r[o+0]-255*e),r[o+1]=Math.abs(r[o+1]-255*e),r[o+2]=Math.abs(r[o+2]-255*e);return t.putImageData(n,0,0),t};f.set("invert",Dt)});var _t,tt=u(()=>{"use strict";F();_t=t=>t;f.set("none",_t)});var Ct,et=u(()=>{"use strict";F();S();Ct=(t,e="1")=>{if(e=v(e),e<0)return t;e>1&&(e=1);let{height:a,width:i}=t.canvas,n=t.getImageData(0,0,i,a),{data:r}=n,{length:s}=r;for(let o=3;o<s;o+=4)r[o]*=e;return t.putImageData(n,0,0),t};f.set("opacity",Ct)});var wt,rt=u(()=>{"use strict";F();S();wt=(t,e="1")=>{let a=v(e);if(a===1)return t;a<0&&(a=0);let{height:i,width:n}=t.canvas,r=t.getImageData(0,0,n,i),{data:s}=r,o=(1-a)*.3086,l=(1-a)*.6094,p=(1-a)*.082,m=n<<2;for(let y=0;y<i;y++){let L=y*m;for(let w=0;w<n;w++){let g=L+(w<<2),D=s[g+0],_=s[g+1],C=s[g+2];s[g+0]=(o+a)*D+l*_+p*C,s[g+1]=o*D+(l+a)*_+p*C,s[g+2]=o*D+l*_+(p+a)*C}}return t.putImageData(r,0,0),t};f.set("saturate",wt)});var Pt,ot=u(()=>{"use strict";F();S();Pt=(t,e="0")=>{if(e=v(e),e<=0)return t;e>1&&(e=1);let{height:a,width:i}=t.canvas,n=t.getImageData(0,0,i,a),{data:r}=n,{length:s}=r;for(let o=0;o<s;o+=4){let l=r[o+0],p=r[o+1],m=r[o+2];r[o+0]=(.393*l+.769*p+.189*m)*e+l*(1-e),r[o+1]=(.349*l+.686*p+.168*m)*e+p*(1-e),r[o+2]=(.272*l+.534*p+.131*m)*e+m*(1-e)}return t.putImageData(n,0,0),t};f.set("sepia",Pt)});function st(t){return bt.includes(t)}var bt,nt=u(()=>{"use strict";bt=["clearRect","clip","drawImage","putImageData","fill","fillRect","fillText","stroke","strokeRect","strokeText","reset","restore"]});var U,at=u(()=>{"use strict";U=class extends Set{applyTo(e){this.forEach(({type:a,prop:i,value:n,args:r})=>{switch(a){case"set":e[i]=n;break;case"apply":e[i](...r);break}})}lastValueOf(e){return[...this].findLast(a=>a.prop===e)}}});function B(t,e,{onDraw:a}){let i={__cloned:!1,__withoutSideEffects:{}},n=Object.getOwnPropertyDescriptors(e.prototype);Object.defineProperties(i,n),Object.keys(n).forEach(r=>{delete e.prototype[r]}),Object.defineProperty(t.prototype,"__history",{get(){return this.___history||(this.___history=new U),this.___history},set(r){this.___history=r}}),Object.setPrototypeOf(e.prototype,new Proxy(i,{get(r,s,o){return s==="__withoutSideEffects"?new Proxy({},{get:(l,p)=>{var m;return(m=r[p])==null?void 0:m.bind(o)}}):s in n&&"value"in n[s]?(...l)=>{var p;if(st(s)){a==null||a(o,s,l),o.canvas.__history.add({type:"draw",prop:s,args:l});return}return o.canvas.__history.add({type:"apply",prop:s,args:l}),(p=r[s])==null?void 0:p.apply(o,l)}:Reflect.get(r,s,o)},set(r,s,o,l){return l.canvas.__history.add({type:"set",prop:s,value:o}),s==="filter"?!0:Reflect.set(r,s,o,l)}}))}var it=u(()=>{"use strict";nt();at()});var lt={};mt(lt,{onDraw:()=>W});function W(t,e,a){var r,s,o,l,p;if(t.__cloned){t.__withoutSideEffects[e](...a);return}let i;t.canvas instanceof HTMLCanvasElement?i=t.canvas.cloneNode():i=new OffscreenCanvas(t.canvas.width,t.canvas.height);let n=i.getContext("2d");switch(n.__cloned=!0,e){case"clearRect":n.drawImage(t.canvas,0,0),t.canvas.__history.applyTo(n),n.clearRect(...a),(s=(r=t.__withoutSideEffects).reset)==null||s.call(r);break;case"reset":t.canvas.__history.clear(),(l=(o=t.__withoutSideEffects).reset)==null||l.call(o);break;default:t.canvas.__history.applyTo(n),n[e](...a),V(n,(p=t.canvas.__history.lastValueOf("filter"))==null?void 0:p.value);break}t.__withoutSideEffects.resetTransform(),t.__withoutSideEffects.drawImage(n.canvas,0,0),window.dispatchEvent(new CustomEvent("context-filter-polyfill:draw",{detail:{original:t,clone:n,drawFn:e,drawArgs:a}}))}var pt=u(()=>{"use strict";Y();$();q();J();K();Q();Z();tt();et();rt();ot();S();it();B(HTMLCanvasElement,CanvasRenderingContext2D,{onDraw:W});typeof OffscreenCanvas!="undefined"&&B(OffscreenCanvas,OffscreenCanvasRenderingContext2D,{onDraw:W})});var A=()=>typeof HTMLCanvasElement!="undefined"&&typeof CanvasRenderingContext2D!="undefined",G=()=>"filter"in CanvasRenderingContext2D.prototype;A()&&!G()&&Promise.resolve().then(()=>(pt(),lt));
//# sourceMappingURL=index.js.map
